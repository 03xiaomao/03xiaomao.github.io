<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1,minimum-scale=1" name="viewport"><meta content="ie=edge" http-equiv="X-UA-Compatible"><meta content="#fff" name="theme-color" id="theme-color"><meta content="Hexo" name="description"><link href="http://mms2.baidu.com/it/u=286036451,3641743280&amp;fm=253&amp;app=138&amp;f=JPEG&amp;fmt=auto&amp;q=75?w=160&amp;h=160" rel="icon"><title>gin-overall</title><meta content="gin-overall" property="og:title"><meta content="https://demo.theme-kaze.top/gin-overall/index.html" property="og:url"><meta content="../img/gin.png" property="og:img"><meta content="gin-overall" property="og:img"><meta content="article" property="og:type"><meta content="2022-09-10" property="og:article:published_time"><meta content="2022-09-19" property="og:article:modified_time"><meta content="xiaomao" property="og:article:author"><link href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" rel="preload" as="style"><link href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" rel="preload" as="style"><link href="/css/main.css" rel="preload" as="style"><link href="//instant.page/5.1.0" rel="modulepreload"><link href="/css/main.css" rel="stylesheet"><link href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" rel="stylesheet"><link href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" rel="stylesheet"><link href="/js/lib/lightbox/baguetteBox.min.css" rel="stylesheet"><script>function loadScript(e,t){var n=document.createElement("script");n.src=e,t&&(n.onload=t),n.async=!0,document.body.appendChild(n)}function loadCSS(e,t,n){var a=document.createElement("link");a.ref="stylesheet",a.href=e,a.dataset[t]=n,document.head.appendChild(a)}function changeCSS(e,t,n){var a=document.querySelector(t),c=document.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("href",e),c.dataset.prism=n,document.head.replaceChild(c,a)}</script><script>function prismThemeChange(){document.getElementById("theme-color").dataset.mode,document.querySelector("[data-prism]")?changeCSS("/js/lib/prism/prism-tomorrow.min.css","[data-prism]","prism-tomorrow"):loadCSS("/js/lib/prism/prism-tomorrow.min.css","prism","prism-tomorrow")}prismThemeChange()</script><link href="/js/lib/prism/prism-line-numbers.min.css" rel="stylesheet"><script>var reverseDarkList={dark:"light",light:"dark"},themeColor={dark:"#1c1c1e",light:"#fff"},getCssMediaQuery=function(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},reverseDarkModeSetting=function(){var e=localStorage.getItem("user-color-scheme");if(reverseDarkList[e])e=reverseDarkList[e];else{if(null!==e)return;e=reverseDarkList[getCssMediaQuery()]}return localStorage.setItem("user-color-scheme",e),e}</script><script>var setDarkmode=function(e){var t=e||localStorage.getItem("user-color-scheme");t===getCssMediaQuery()?(document.documentElement.removeAttribute("data-user-color-scheme"),localStorage.removeItem("user-color-scheme"),document.getElementById("theme-color").content=themeColor[t],document.getElementById("theme-color").dataset.mode=t):reverseDarkList[t]?(document.documentElement.setAttribute("data-user-color-scheme",t),document.getElementById("theme-color").content=themeColor[t],document.getElementById("theme-color").dataset.mode=t):(document.documentElement.removeAttribute("data-user-color-scheme"),localStorage.removeItem("user-color-scheme"),document.getElementById("theme-color").content=themeColor[getCssMediaQuery()],document.getElementById("theme-color").dataset.mode=getCssMediaQuery()),prismThemeChange()};setDarkmode()</script><link href="/js/lib/lightbox/baguetteBox.min.js" rel="preload" as="script"><link href="/js/lib/lightbox/baguetteBox.min.css" rel="preload" as="style"><link href="/js/lib/lozad.min.js" rel="preload" as="script"><link href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" rel="prefetch" as="script"><link href="//unpkg.com/valine/dist/Valine.min.js" rel="prefetch" as="script"><meta content="Hexo 5.1.1" name="generator"></head><body><div class="wrapper"><nav class="navbar"><div class="navbar-logo"><a href="/" class="navbar-logo-main"><img alt="blog logo" class="navbar-logo-img" src="http://mms2.baidu.com/it/u=286036451,3641743280&fm=253&app=138&f=JPEG&fmt=auto&q=75?w=160&h=160" height="32" width="32"> <span class="navbar-logo-dsc">xiaomao blog</span></a></div><div class="navbar-menu"><a href="/" class="navbar-menu-item">首页 </a><a href="/archives" class="navbar-menu-item">归档 </a><a href="/tags" class="navbar-menu-item">标签 </a><a href="/categories" class="navbar-menu-item">分类 </a><a href="/about" class="navbar-menu-item">关于 </a><a href="/links" class="navbar-menu-item">友链 </a><button aria-label="Toggle dark mode" class="navbar-menu-item navbar-menu-btn darknavbar" id="dark"><i class="iconfont icon-weather"></i></button> <button aria-label="Toggle search" class="navbar-menu-item navbar-menu-btn searchnavbar" id="search"><!-- <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i> --> <svg aria-hidden="true" class="iconify iconify--ion" height="28" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 512 512" width="28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80Z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"></path><path d="M232 160a72 72 0 1 0 72 72a72 72 0 0 0-72-72Z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"></path><path d="M283.64 283.64L336 336" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28" stroke-linecap="round"></path></svg></button></div></nav><div id="local-search" style="display:none"><input class="navbar-menu-item" id="search-input" placeholder="请输入搜索内容..."><div id="search-content"></div></div><div class="section-wrap"><div class="container"><div class="columns"><aside class="left-column"><div class="card card-author"><img alt="author avatar" class="author-img" src="http://mms2.baidu.com/it/u=286036451,3641743280&fm=253&app=138&f=JPEG&fmt=auto&q=75?w=160&h=160" height="88" width="88"><p class="author-name">xiaomao</p><p class="author-description">welcome xiaomao blog</p><div class="author-message"><a href="/archives" class="author-posts-count"><span>6</span> <span>文章</span> </a><a href="/categories" class="author-categories-count"><span>4</span> <span>分类</span> </a><a href="/tags" class="author-tags-count"><span>0</span> <span>标签</span></a></div><div class="author-card-society"><div class="author-card-society-icon"><a href="https://github.com/03xiaomao" rel="noopener" target="_blank"><i class="iconfont society-icon icon-github"></i></a></div><div class="author-card-society-icon"><a href="heyingjie_xiaomao@163.com"><i class="iconfont society-icon icon-mail"></i></a></div><div class="author-card-society-icon"><a href="https://www.google.cn/chrome/" rel="noopener" target="_blank"><i class="iconfont society-icon icon-chrome"></i></a></div></div></div><div class="sticky-tablet"><article class="display-when-two-columns spacer"><div class="card card-content toc-card"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-1"><a href="#gin-overall" class="toc-link"><span class="toc-text">Gin-overall</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a href="#1router" class="toc-link"><span class="toc-text">1.router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#11-%E8%B7%AF%E7%94%B1%E5%AE%9A%E4%B9%89%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">1.1 路由定义例子</span></a></li><li class="toc-item toc-level-3"><a href="#12-%E5%88%86%E7%BB%84%E8%B7%AF%E7%94%B1" class="toc-link"><span class="toc-text">1.2 分组路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#2%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.处理请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#21-%E8%8E%B7%E5%8F%96get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.1 获取Get请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#22-%E8%8E%B7%E5%8F%96post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.2 获取Post请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#23-%E8%8E%B7%E5%8F%96url%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.3 获取URL路径参数</span></a></li><li class="toc-item toc-level-3"><a href="#24-%E5%B0%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9Astruct%E5%AF%B9%E8%B1%A1" class="toc-link"><span class="toc-text">2.4 将请求参数绑定struct对象</span></a></li><li class="toc-item toc-level-3"><a href="#25-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7ip" class="toc-link"><span class="toc-text">2.5 获取客户ip</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#3-%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C" class="toc-link"><span class="toc-text">3. 返回响应结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#31-%E4%BB%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.1 以字符串方式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#32-%E4%BB%A5json-xml%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.2 以json、xml格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#33-%E4%BB%A5%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.3 以文件格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#34-%E8%AE%BE%E7%BD%AEhttp%E5%93%8D%E5%BA%94%E5%A4%B4" class="toc-link"><span class="toc-text">3.4 设置http响应头</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#4-html%E6%A8%A1%E6%9D%BF%E5%A4%84%E7%90%86" class="toc-link"><span class="toc-text">4. html模板处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#41-%E8%BF%94%E5%9B%9Ehtml%E7%BB%93%E6%9E%9C%E7%9A%84%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">4.1 返回html结果的例子</span></a></li><li class="toc-item toc-level-3"><a href="#42-%E5%A4%84%E7%90%86%E6%A8%A1%E7%89%88%E5%AD%90%E7%9B%AE%E5%BD%95%E7%9A%84%E6%83%85%E5%86%B5" class="toc-link"><span class="toc-text">4.2 处理模版子目录的情况</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#5-%E8%AE%BF%E9%97%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">5. 访问静态资源文件</span></a></li><li class="toc-item toc-level-2"><a href="#6-%E5%A4%84%E7%90%86cookie" class="toc-link"><span class="toc-text">6. 处理cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#61-%E8%AE%BE%E7%BD%AEcookie" class="toc-link"><span class="toc-text">6.1 设置cookie</span></a></li><li class="toc-item toc-level-3"><a href="#62-%E8%AF%BB%E5%8F%96cookie" class="toc-link"><span class="toc-text">6.2 读取cookie</span></a></li><li class="toc-item toc-level-3"><a href="#63-%E5%88%A0%E9%99%A4cookie" class="toc-link"><span class="toc-text">6.3 删除cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#7-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" class="toc-link"><span class="toc-text">7. 文件上传</span></a></li><li class="toc-item toc-level-2"><a href="#8-%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8. 中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#81-%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.1 使用中间件</span></a></li><li class="toc-item toc-level-3"><a href="#82-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.2 自定义中间件</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#9-%E5%A4%84%E7%90%86session" class="toc-link"><span class="toc-text">9. 处理session</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#91-%E5%AE%89%E8%A3%85session%E5%8C%85" class="toc-link"><span class="toc-text">9.1 安装session包</span></a></li><li class="toc-item toc-level-3"><a href="#92-%E5%9F%BA%E6%9C%AC%E7%9A%84session%E7%94%A8%E6%B3%95" class="toc-link"><span class="toc-text">9.2 基本的session用法</span></a></li><li class="toc-item toc-level-3"><a href="#93-%E5%9F%BA%E4%BA%8Eredis%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84session" class="toc-link"><span class="toc-text">9.3 基于redis存储引擎的session</span></a></li></ol></li></ol></li></ol></div></article><article class="card card-content categories-widget"><div class="categories-card"><div class="categories-header"><i class="iconfont icon-fenlei" style="padding-right:2px"></i>分类</div><div class="categories-list"><a href="/categories/gin/"><div class="categories-list-item">gin <span class="categories-list-item-badge">2</span></div></a><a href="/categories/network/"><div class="categories-list-item">network <span class="categories-list-item-badge">1</span></div></a><a href="/categories/go/"><div class="categories-list-item">go <span class="categories-list-item-badge">2</span></div></a><a href="/categories/mysql/"><div class="categories-list-item">mysql <span class="categories-list-item-badge">1</span></div></a></div></div></article><article class="card card-content tags-widget"><div class="tags-card"><div class="tags-header"><i class="iconfont icon-biaoqian" style="padding-right:2px"></i>热门标签</div><div class="tags-list"></div></div></article></div></aside><main class="main-column"><div class="image-wrapper"><img alt="gin-overall thumbnail" class="image lozad" src="../img/gin.png" data-src="../img/gin.png" srcset="../img/gin.png"></div><article class="card card-content"><header><h1 class="post-title">gin-overall</h1></header><div class="post-meta post-show-meta"><time datetime="2022-09-10T04:22:27.000Z"><i class="iconfont icon-calendar" style="margin-right:2px"></i> <span>2022-09-10</span> </time><span class="dot"></span> <a href="/categories/gin/" class="post-meta-link">gin </a><span class="dot"></span> <span>3.7k 字</span></div><div class="post-content" id="section"><h1 id="gin-overall"><a href="#gin-overall" class="markdownIt-Anchor"></a> Gin-overall</h1><h2 id="1router"><a href="#1router" class="markdownIt-Anchor"></a> 1.router</h2><h3 id="11-路由定义例子"><a href="#11-路由定义例子" class="markdownIt-Anchor"></a> 1.1 路由定义例子</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token comment">// 实例化gin实例对象</span>
r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 定义POST请求，url路径为：/users，绑定saveUser控制器函数</span>
r<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/users"</span><span class="token punctuation">,</span> saveUser<span class="token punctuation">)</span>

<span class="token comment">// 定义GET请求，url路径为：/users/:id，(:id是参数，例如/users/10，会匹配这个url模式)，绑定getUser控制器函数</span>
r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/users/:id"</span><span class="token punctuation">,</span> getUser<span class="token punctuation">)</span>

<span class="token comment">// 定义PUT请求</span>
r<span class="token punctuation">.</span><span class="token function">PUT</span><span class="token punctuation">(</span><span class="token string">"/users/:id"</span><span class="token punctuation">,</span> updateUser<span class="token punctuation">)</span>

<span class="token comment">// 定义DELETE请求</span>
r<span class="token punctuation">.</span><span class="token function">DELETE</span><span class="token punctuation">(</span><span class="token string">"/users/:id"</span><span class="token punctuation">,</span> deleteUser<span class="token punctuation">)</span>

<span class="token comment">// 控制器函数</span>
<span class="token keyword">func</span> <span class="token function">saveUser</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> <span class="token string">"root login success"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">getUser</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="12-分组路由"><a href="#12-分组路由" class="markdownIt-Anchor"></a> 1.2 分组路由</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">loginEndpoint</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> <span class="token string">"login, root login success"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">func</span> <span class="token function">submitEndpoint</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">func</span> <span class="token function">readEndpoint</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">// 设置release模式</span>
	gin<span class="token punctuation">.</span><span class="token function">SetMode</span><span class="token punctuation">(</span>gin<span class="token punctuation">.</span>ReleaseMode<span class="token punctuation">)</span>

	<span class="token comment">// 设置debug模式</span>
	<span class="token comment">// gin.SetMode(gin.DebugMode)</span>

	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// 创建v1组</span>
	v1 <span class="token operator">:=</span> router<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"v1"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">// v1在这个分组下，注册路由</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> loginEndpoint<span class="token punctuation">)</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">,</span> submitEndpoint<span class="token punctuation">)</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/read"</span><span class="token punctuation">,</span> readEndpoint<span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">// 创建v2组</span>
	v2 <span class="token operator">:=</span> router<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"v2"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">// v2在这个分组下，注册路由</span>
		v2<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> loginEndpoint<span class="token punctuation">)</span>
		v2<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">,</span> submitEndpoint<span class="token punctuation">)</span>
		v2<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/read"</span><span class="token punctuation">,</span> readEndpoint<span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8000"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2处理请求参数"><a href="#2处理请求参数" class="markdownIt-Anchor"></a> 2.处理请求参数</h2><h3 id="21-获取get请求参数"><a href="#21-获取get请求参数" class="markdownIt-Anchor"></a> 2.1 获取Get请求参数</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go">获取Get请求参数的常用函数：
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">Query</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">DefaultQuery</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> defaultValue <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">GetQuery</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">bool</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token comment">// 获取name参数, 通过Query获取的参数值是String类型。</span>
    name <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
   
    <span class="token comment">// 获取name参数, 跟Query函数的区别是，可以通过第二个参数设置默认值。</span>
    name <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">DefaultQuery</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"03xiaomao"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 获取id参数, 通过GetQuery获取的参数值也是String类型, </span>
    <span class="token comment">// 区别是GetQuery返回两个参数，第一个是参数值，第二个参数是参数是否存在的bool值，可以用来判断参数是否存在。</span>
    id<span class="token punctuation">,</span> ok <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">GetQuery</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">&#123;</span>
        <span class="token comment">// 参数不存在</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// GetQuery函数，判断参数是否存在的逻辑是，参数值为空，参数也算存在，只有没有提交参数，才算参数不存在。</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="22-获取post请求参数"><a href="#22-获取post请求参数" class="markdownIt-Anchor"></a> 2.2 获取Post请求参数</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token comment">// 获取Post请求参数的常用函数：</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">PostForm</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">DefaultPostForm</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> defaultValue <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">GetPostForm</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">bool</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 获取name参数, 通过PostForm获取的参数值是String类型。</span>
    name <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">PostForm</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 跟PostForm的区别是可以通过第二个参数设置参数默认值</span>
    name <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">DefaultPostForm</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"03xiaomao"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 获取id参数, 通过GetPostForm获取的参数值也是String类型,</span>
    <span class="token comment">// 区别是GetPostForm返回两个参数，第一个是参数值，第二个参数是参数是否存在的bool值，可以用来判断参数是否存在。</span>
    id<span class="token punctuation">,</span> ok <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">GetPostForm</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">&#123;</span>
        <span class="token comment">// 参数不存在</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="23-获取url路径参数"><a href="#23-获取url路径参数" class="markdownIt-Anchor"></a> 2.3 获取URL路径参数</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token comment">// 获取url路径参数常用函数：</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">Param</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go">r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/user/:id"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 获取url参数id</span>
    id <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="24-将请求参数绑定struct对象"><a href="#24-将请求参数绑定struct对象" class="markdownIt-Anchor"></a> 2.4 将请求参数绑定struct对象</h3><p>前面获取参数的方式都是一个个参数的读取，比较麻烦。</p><p>Gin框架支持将请求参数自动绑定到一个struct对象，这种方式支持Get/Post请求，也支持http请求body内容为json/xml格式的参数。</p><p><strong>Gin提供了两类绑定方法：</strong></p><ul><li><p>Must bind</p><ul><li><p><strong>Methods -</strong> <code>Bind</code>, <code>BindJSON</code>, <code>BindXML</code>, <code>BindQuery</code>, <code>BindYAML</code></p></li><li><p><strong>Behavior -</strong> 这些方法属于 <code>MustBindWith</code> 的具体调用。 如果发生绑定错误，则请求终止，并触发 <code>c.AbortWithError(400, err).SetType(ErrorTypeBind)</code>。响应状态码被设置为 400 并且 <code>Content-Type</code> 被设置为 <code>text/plain</code>; <code>charset=utf-8</code>。 如果您在此之后尝试设置响应状态码，Gin会输出日志 <code>[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 400 with 422</code>。 如果您希望更好地控制绑定，考虑使用 ShouldBind 等效方法。</p></li></ul></li><li><p>Should bind</p><ul><li><strong>Methods -</strong> <code>ShouldBind</code>, <code>ShouldBindJSON</code>, <code>ShouldBindXML</code>, <code>ShouldBindQuery</code>, <code>ShouldBindYAML</code></li><li>**Behavior - **这些方法属于 <code>ShouldBindWith</code> 的具体调用。 如果发生绑定错误，Gin 会返回错误并由开发者处理错误和请求。</li></ul></li></ul><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
	Name <span class="token builtin">string</span> <span class="token string">`json:"name" form:"name"`</span>
	Email <span class="token builtin">string</span> <span class="token string">`json:"email" form:"email"`</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go">r<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/user/:id"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 初始化 user struct</span>
    u <span class="token operator">:=</span> User<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    
    <span class="token comment">// 通过 ShouldBind 函数，将请求参数绑定到 struct 对象， 处理 json 请求代码是一样的。</span>
    <span class="token comment">// 如果是 post 请求则根据 Content-Type 判断，接收的是 json 数据，还是普通的 http 请求参数</span>
    <span class="token keyword">if</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 绑定成功， 打印请求参数</span>
        log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
        log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>Email<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">// http 请求返回一个字符串 </span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"Success"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token comment">// 如果通过http请求body传递json格式的请求参数，并且通过post请求的方式提交参数，则需要将 Content-Type 设置为 application/json , 如果是xml格式的数据，则设置为 application/xml</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="25-获取客户ip"><a href="#25-获取客户ip" class="markdownIt-Anchor"></a> 2.5 获取客户ip</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go">r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/ip"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 获取用户IP</span>
    ip <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ClientIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-返回响应结果"><a href="#3-返回响应结果" class="markdownIt-Anchor"></a> 3. 返回响应结果</h2><p>Gin框架支持以字符串、json、xml、文件等格式响应请求。</p><h3 id="31-以字符串方式响应请求"><a href="#31-以字符串方式响应请求" class="markdownIt-Anchor"></a> 3.1 以字符串方式响应请求</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token comment">// 通过String函数返回字符串。</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Context<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span>code <span class="token builtin">int</span><span class="token punctuation">,</span> format <span class="token builtin">string</span><span class="token punctuation">,</span> values <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre><p>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>code</td><td>http状态码</td></tr><tr><td>format</td><td>返回结果，支持类似Sprintf函数一样的字符串格式定义，例如,%d 代表插入整数，%s代表插入字符串</td></tr><tr><td>values</td><td>任意个format参数定义的字符串格式参数</td></tr></tbody></table><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"欢迎03xiaomao"</span><span class="token punctuation">)</span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"欢迎%s"</span><span class="token punctuation">,</span> <span class="token number">03</span>xiaomao<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="32-以json-xml格式响应请求"><a href="#32-以json-xml格式响应请求" class="markdownIt-Anchor"></a> 3.2 以json、xml格式响应请求</h3><p>开发api接口的时候常用的格式就是<code>json</code> :</p><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token comment">// User 定义</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    Name <span class="token builtin">string</span> <span class="token string">`json:"name" xml:"name"`</span> 	<span class="token comment">// 通过json标签定义struct字段转换成json字段的名字</span>
    Email <span class="token builtin">string</span> <span class="token string">`json:"email" xml:"email"`</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// Handler 控制器</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 初始化user对象</span>
    u <span class="token operator">:=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">&#123;</span>
        Name<span class="token punctuation">:</span> <span class="token string">"03xiaomao"</span>
        Email<span class="token punctuation">:</span> <span class="token string">"03xiaomao"</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">// 返回json数据</span>
    c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span>
    <span class="token comment">// c.XML(200, u)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="33-以文件格式响应请求"><a href="#33-以文件格式响应请求" class="markdownIt-Anchor"></a> 3.3 以文件格式响应请求</h3><p>下面介绍gin框架如何直接返回一个文件，可以用来做文件下载。</p><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 通过File函数，直接返回本地文件，参数为本地文件地址。</span>
    <span class="token comment">// 函数说明：c.File("文件路径")</span>
    c<span class="token punctuation">.</span><span class="token function">File</span><span class="token punctuation">(</span><span class="token string">"/var/www/1.jpg"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 通过FileAttachment函数，返回本地文件，类似File函数，区别是可以指定下载的文件名。</span>
    <span class="token comment">// 函数说明: c.FileAttachment("文件路径", "下载的文件名")</span>
    c<span class="token punctuation">.</span><span class="token function">FileAttachment</span><span class="token punctuation">(</span><span class="token string">"/var/www/1.jpg"</span><span class="token punctuation">,</span> <span class="token string">"1.jpg"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="34-设置http响应头"><a href="#34-设置http响应头" class="markdownIt-Anchor"></a> 3.4 设置http响应头</h3><p>设置Header：</p><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 设置http响应 header, key/value方式，支持设置多个header</span>
	c<span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">"site"</span><span class="token punctuation">,</span> <span class="token string">"03xiaomao"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-html模板处理"><a href="#4-html模板处理" class="markdownIt-Anchor"></a> 4. html模板处理</h2><h3 id="41-返回html结果的例子"><a href="#41-返回html结果的例子" class="markdownIt-Anchor"></a> 4.1 返回html结果的例子</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">// 初始化gin对象</span>
    router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 首先加载templates目录下面的所有模版文件，模版文件扩展名随意</span>
    router<span class="token punctuation">.</span><span class="token function">LoadHTMLGlob</span><span class="token punctuation">(</span><span class="token string">"templates/*"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 绑定一个url路由 /index</span>
    router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 通过HTML函数返回html代码</span>
        <span class="token comment">// 第二个参数是模版文件名字</span>
        <span class="token comment">// 第三个参数是map类型，代表模版参数</span>
        <span class="token comment">// gin.H 是 map[string]interface&#123;&#125; 类型的别名</span>
        c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOk<span class="token punctuation">,</span> <span class="token string">"index.html"</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
            <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Main website"</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 启动http服务，并且绑定在8080端口</span>
    router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>模板代码</p><p>文件名：templates/index.html</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>
		&#123;&#123; .title &#125;&#125;
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="42-处理模版子目录的情况"><a href="#42-处理模版子目录的情况" class="markdownIt-Anchor"></a> 4.2 处理模版子目录的情况</h3><p>一般在项目中，因为有多个模块的模版文件，则以多个子目录的方式来组织模版文件，上面的例子只能加载某个目录下面的模版文件，无法加载子目录的模版文件。</p><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
    <span class="token comment">// 加载templates目录下面的所有模版文件，包括子目录</span>
    <span class="token comment">// **/* 代表所有子目录下的所有文件</span>
    router<span class="token punctuation">.</span><span class="token function">LoadHTMLGlob</span><span class="token punctuation">(</span><span class="token string">"templates/**/*"</span><span class="token punctuation">)</span>
    
    router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/posts/index"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 子目录的模版文件，需要加上目录名，例如：posts/index.tmpl</span>
        c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> <span class="token string">"posts/index.tmpl"</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
            <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Posts"</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    
    router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/users/index"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 子目录的模版文件，需要加上目录名，例如：users/index.tmpl</span>
        c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> <span class="token string">"users/index.tmpl"</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
            <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Users"</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    
    router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>模版文件：templates/posts/index.tmpl</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&#123;&#123; define "posts/index.tmpl" &#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>
		&#123;&#123; .title &#125;&#125;
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Using posts/index.tmpl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>P</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
&#123;&#123; end &#125;&#125;<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>模版文件：templates/users/index.tmpl</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&#123;&#123; define "users/index.tmpl" &#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>
		&#123;&#123; .title &#125;&#125;
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Using users/index.tmpl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>P</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
&#123;&#123; end &#125;&#125;<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-访问静态资源文件"><a href="#5-访问静态资源文件" class="markdownIt-Anchor"></a> 5. 访问静态资源文件</h2><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
	<span class="token comment">// 设置静态资源文件目录，并且绑定一个Url前缀</span>
    <span class="token comment">// 静态资源文件目录：/var/www/tizi365/assets</span>
    <span class="token comment">// /assets是访问静态资源的url前缀</span>
    <span class="token comment">// /assets/images/1.jpg 这个url文件，存储在/var/www/tizi365/assets/images/1.jpg</span>
	router<span class="token punctuation">.</span><span class="token function">Static</span><span class="token punctuation">(</span><span class="token string">"/assets"</span><span class="token punctuation">,</span> <span class="token string">"/var/www/03xiaomao/assets"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 为单个静态资源文件，绑定url</span>
    <span class="token comment">// 这里的意思就是将/favicon.ico这个url，绑定到./resources/favicon.ico这个文件</span>
    router<span class="token punctuation">.</span><span class="token function">StaticFile</span><span class="token punctuation">(</span><span class="token string">"/favicon.ico"</span><span class="token punctuation">,</span> <span class="token string">"./resources/favicon.ico"</span><span class="token punctuation">)</span>
    
    <span class="token comment">// Listen and serve on 0.0.0.0:8080</span>
    router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 设置 /favicon.ico 这个url，其实就是为网站设置图标，浏览器默认会将这个url作为网站默认图标。</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-处理cookie"><a href="#6-处理cookie" class="markdownIt-Anchor"></a> 6. 处理cookie</h2><p>cookie通常用于在浏览器中保存一些小数据，例如客户标识、用户非敏感数据。</p><p>gin框架主要通过上下文对象提供的 <code>SetCookie</code>和<code>Cookie</code>两个函数操作cookie</p><h3 id="61-设置cookie"><a href="#61-设置cookie" class="markdownIt-Anchor"></a> 6.1 设置cookie</h3><p><code>SetCookie</code>函数定义：</p><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>context<span class="token punctuation">)</span> <span class="token function">SetCookie</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value <span class="token builtin">string</span><span class="token punctuation">,</span> maxAge <span class="token builtin">int</span><span class="token punctuation">,</span> path<span class="token punctuation">,</span> domain <span class="token builtin">string</span><span class="token punctuation">,</span> secure<span class="token punctuation">,</span> httpOnly <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre><p>参数说明：</p><table><thead><tr><th>参数名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>string</td><td>cookie名字</td></tr><tr><td>value</td><td>string</td><td>cookie值</td></tr><tr><td>maxAge</td><td>int</td><td>有效时间，单位是秒，<br>MaxAge=0 忽略MaxAge属性，<br>MaxAge&lt;0 相当于删除cookie, 通常可以设置-1代表删除，<br>MaxAge&gt;0 多少秒后cookie失效</td></tr><tr><td>path</td><td>string</td><td>cookie路径</td></tr><tr><td>domain</td><td>string</td><td>cookie作用域</td></tr><tr><td>secure</td><td>bool</td><td>Secure=true，那么这个cookie只能用https协议发送给服务器</td></tr><tr><td>httpOnly</td><td>bool</td><td>设置 HttpOnly=true 的cookie不能被js获取到</td></tr></tbody></table><h3 id="62-读取cookie"><a href="#62-读取cookie" class="markdownIt-Anchor"></a> 6.2 读取cookie</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 根据cookie名字读取cookie值</span>
	data<span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Cookie</span><span class="token punctuation">(</span><span class="token string">"site_cookie"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 直接返回cookie值</span>
        c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    	<span class="token keyword">return</span>
    <span class="token punctuation">&#125;</span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"not found!"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="63-删除cookie"><a href="#63-删除cookie" class="markdownIt-Anchor"></a> 6.3 删除cookie</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    c<span class="token punctuation">.</span><span class="token function">SetCookie</span><span class="token punctuation">(</span><span class="token string">"site_cookie"</span><span class="token punctuation">,</span><span class="token string">"cookievalue"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"删除cookie演示"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="7-文件上传"><a href="#7-文件上传" class="markdownIt-Anchor"></a> 7. 文件上传</h2><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 设置文件上传大小限制，默认是32m</span>
    router<span class="token punctuation">.</span>MaxMultipartMemory <span class="token operator">=</span> <span class="token number">64</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span>	<span class="token comment">// 64Mib </span>
    
    router<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/upload"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 获取上传文件，返回的是multipart.FileHeader对象，代表一个文件，里面包含了文件名之类的详细信息</span>
        <span class="token comment">// file 是表单字段名字</span>
        file<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">FormFile</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span>
        
        <span class="token comment">// 打印上传的文件名</span>
        log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span>
        
        <span class="token comment">// 将上传的文件，保存到 ./data/1111.jpg 文件中</span>
        c<span class="token punctuation">.</span><span class="token function">SaveUploadedFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"./data/1111.jpg"</span><span class="token punctuation">)</span>
        
        c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"'%s' uploaded!"</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/upload<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mutipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
     文件: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>文件上传<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-中间件"><a href="#8-中间件" class="markdownIt-Anchor"></a> 8. 中间件</h2><p>在Gin框架中，<strong>中间件</strong>（Middleware）指的是可以拦截<strong>http请求-响应</strong>生命周期的特殊函数，在请求-响应生命周期中可以注册多个中间件，每个中间件执行不同的功能，一个中间执行完再轮到下一个中间件执行。</p><p><strong>中间件的常见应用场景如下：</strong></p><ul><li>请求限速</li><li>api接口签名处理</li><li>权限校验</li><li>统一错误处理</li></ul><p>Gin支持设置全局中间件和针对路由分组设置中间件:</p><ul><li>全局中间件会拦截所有请求</li><li>分组路由设置中间件，仅对这个分组下的路由起作用</li></ul><h3 id="81-使用中间件"><a href="#81-使用中间件" class="markdownIt-Anchor"></a> 8.1 使用中间件</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	<span class="token comment">// 通过use设置全局中间件</span>
	<span class="token comment">// 设置日志中间件，主要用于打印请求日志</span>
	r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>gin<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	
	<span class="token comment">// 设置Recovery中间件，主要用于拦截paic错误，不至于导致进程崩掉</span>
	r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>gin<span class="token punctuation">.</span><span class="token function">Recovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="82-自定义中间件"><a href="#82-自定义中间件" class="markdownIt-Anchor"></a> 8.2 自定义中间件</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        t <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment">// 可以通过上下文对象，设置一些依附在上下文对象里面的键/值数据</span>
        c<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"example"</span><span class="token punctuation">,</span> <span class="token string">"12345"</span><span class="token punctuation">)</span>
        
        <span class="token comment">// 在这里处理请求到达控制器函数之前的逻辑</span>
        <span class="token comment">// 调用下一个中间件，或者控制器处理函数，具体得看注册了多少个中间件。</span>
        c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment">// 在这里可以处理请求返回给用户之前的逻辑</span>
        latency <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
        log<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span>
        
        <span class="token comment">// 例如，查询请求状态ma</span>
        status <span class="token operator">:=</span> c<span class="token punctuation">.</span>Writer<span class="token punctuation">.</span><span class="token function">Status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 注册上面自定义的日志中间件</span>
    r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        
        <span class="token comment">// 查询我们之前在日志中间件，注入的键值数据</span>
        example <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">MustGet</span><span class="token punctuation">(</span><span class="token string">"example"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
        
        <span class="token comment">// it would print: "12345"</span>
        log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    
    <span class="token comment">// Listen and serve on 0.0.0.0:8080</span>
    r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="9-处理session"><a href="#9-处理session" class="markdownIt-Anchor"></a> 9. 处理session</h2><p>在Gin框架中，依赖 <a href="https://github.com/gin-contrib/sessions" rel="noopener" target="_blank">gin-contrib/sessions</a>中间件处理session。</p><p>gin-contrib/sessions中间件支持的存储引擎：</p><ul><li>cookie</li><li>memstore</li><li>redis</li><li>memcached</li><li>mongodb</li></ul><h3 id="91-安装session包"><a href="#91-安装session包" class="markdownIt-Anchor"></a> 9.1 安装session包</h3><pre class="line-numbers language-none"><code class="language-none">go get github.com&#x2F;gin-contrib&#x2F;sessions<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre><h3 id="92-基本的session用法"><a href="#92-基本的session用法" class="markdownIt-Anchor"></a> 9.2 基本的session用法</h3><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
    <span class="token comment">// 创建基于cookie的存储引擎，secret11111 参数是用于加密的密钥</span>
	store <span class="token operator">:=</span> cookie<span class="token punctuation">.</span><span class="token function">NewStore</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"secret11111"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	
    <span class="token comment">// 设置session中间件，参数mysession，指的是session的名字，也是cookie的名字</span>
    <span class="token comment">// store是前面创建的存储引擎，可以替换成其他存储引擎</span>
    r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>sessions<span class="token punctuation">.</span><span class="token function">Sessions</span><span class="token punctuation">(</span><span class="token string">"mysession"</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 初始化session对象</span>
        session <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
        
        <span class="token comment">// 通过session.Get读取session值</span>
        <span class="token comment">// session是键值对格式数据，因此需要通过key查询数据</span>
        <span class="token keyword">if</span> session<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"world"</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 设置session数据</span>
            session<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span>
            <span class="token comment">// 删除session数据</span>
            session<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">"03xiaomao"</span><span class="token punctuation">)</span>
            <span class="token comment">// 保存session数据</span>
            session<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 删除整个session</span>
            <span class="token comment">// session.Clear()</span>
        <span class="token punctuation">&#125;</span>
        
        c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"hello"</span><span class="token punctuation">:</span> session<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8000"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="93-基于redis存储引擎的session"><a href="#93-基于redis存储引擎的session" class="markdownIt-Anchor"></a> 9.3 基于redis存储引擎的session</h3><p>如果想将session数据保存到redis中，只要将session的存储引擎改成redis即可。</p><p>使用redis作为存储引擎的例子：</p><p>首先安装redis存储引擎的包</p><pre class="line-numbers language-none"><code class="language-none">go get github.com&#x2F;gin-contrib&#x2F;sessions&#x2F;redis<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre><pre class="language-go line-numbers" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/gin-contrib/sessions"</span>
    <span class="token string">"github.com/gin-contrib/sessions/redis"</span>
    <span class="token string">"github.com/gin-gonic/gin"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 初始化基于redis的存储引擎</span>
    <span class="token comment">// 参数说明：</span>
    <span class="token comment">//    第1个参数 - redis最大的空闲连接数</span>
    <span class="token comment">//    第2个参数 - 数通信协议tcp或者udp</span>
    <span class="token comment">//    第3个参数 - redis地址, 格式，host:port</span>
    <span class="token comment">//    第4个参数 - redis密码</span>
    <span class="token comment">//    第5个参数 - session加密密钥</span>
    store<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">NewStore</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"tcp"</span><span class="token punctuation">,</span> <span class="token string">"localhost:6379"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">"secret"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>sessions<span class="token punctuation">.</span><span class="token function">Sessions</span><span class="token punctuation">(</span><span class="token string">"mysession"</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">)</span>
	
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/incr"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		session <span class="token operator">:=</span> sessions<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
		<span class="token keyword">var</span> count <span class="token builtin">int</span>
		v <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> v <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
			count <span class="token operator">=</span> <span class="token number">0</span>
		<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
			count <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
			count<span class="token operator">++</span>
		<span class="token punctuation">&#125;</span>
		session<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>
		session<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span><span class="token string">"count"</span><span class="token punctuation">:</span> count<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8000"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>// netstat -aon | findstr :端口</p><p>// 查看该端口下的应用</p></div><div></div></article><div class="nav"><div class="nav-item-prev"><a href="/go-module/" class="nav-link"><i class="iconfont icon-left nav-prev-icon"></i><div><div class="nav-label">上一篇</div><div class="nav-title">go module</div></div></a></div><div class="nav-item-next"><a href="/gin-install/" class="nav-link"><div><div class="nav-label">下一篇</div><div class="nav-title">gin-install</div></div><i class="iconfont icon-right nav-next-icon"></i></a></div></div><div class="card card-content comment-card" style="margin-top:16px"><div class="comment-card-title">评论</div><div id="vcomments"></div><script>loadScript("//unpkg.com/valine/dist/Valine.min.js");var oldLoadVa=window.onload;window.onload=function(){oldLoadVa&&oldLoadVa(),new Valine({el:"#vcomments",appId:"KxoK4Ebe5ijWF46B3vEOweiw-MdYXbMMI",appKey:"CTkC6yslbM9aItMbEqdhJd3d",placeholder:"欢迎评论",path:window.location.pathname,avatar:"mp",meta:["nick","mail","link"],pageSize:"10",lang:"",visitor:"false",highlight:!0,recordIP:!1,serverURLs:"https://kxok4ebe.api.lncldglobal.com",enableQQ:"false",requiredFields:[]})}</script></div><div class="card card-content toc-card" id="mobiletoc"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-1"><a href="#gin-overall" class="toc-link"><span class="toc-text">Gin-overall</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a href="#1router" class="toc-link"><span class="toc-text">1.router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#11-%E8%B7%AF%E7%94%B1%E5%AE%9A%E4%B9%89%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">1.1 路由定义例子</span></a></li><li class="toc-item toc-level-3"><a href="#12-%E5%88%86%E7%BB%84%E8%B7%AF%E7%94%B1" class="toc-link"><span class="toc-text">1.2 分组路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#2%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.处理请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#21-%E8%8E%B7%E5%8F%96get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.1 获取Get请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#22-%E8%8E%B7%E5%8F%96post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.2 获取Post请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#23-%E8%8E%B7%E5%8F%96url%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.3 获取URL路径参数</span></a></li><li class="toc-item toc-level-3"><a href="#24-%E5%B0%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9Astruct%E5%AF%B9%E8%B1%A1" class="toc-link"><span class="toc-text">2.4 将请求参数绑定struct对象</span></a></li><li class="toc-item toc-level-3"><a href="#25-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7ip" class="toc-link"><span class="toc-text">2.5 获取客户ip</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#3-%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C" class="toc-link"><span class="toc-text">3. 返回响应结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#31-%E4%BB%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.1 以字符串方式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#32-%E4%BB%A5json-xml%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.2 以json、xml格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#33-%E4%BB%A5%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.3 以文件格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#34-%E8%AE%BE%E7%BD%AEhttp%E5%93%8D%E5%BA%94%E5%A4%B4" class="toc-link"><span class="toc-text">3.4 设置http响应头</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#4-html%E6%A8%A1%E6%9D%BF%E5%A4%84%E7%90%86" class="toc-link"><span class="toc-text">4. html模板处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#41-%E8%BF%94%E5%9B%9Ehtml%E7%BB%93%E6%9E%9C%E7%9A%84%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">4.1 返回html结果的例子</span></a></li><li class="toc-item toc-level-3"><a href="#42-%E5%A4%84%E7%90%86%E6%A8%A1%E7%89%88%E5%AD%90%E7%9B%AE%E5%BD%95%E7%9A%84%E6%83%85%E5%86%B5" class="toc-link"><span class="toc-text">4.2 处理模版子目录的情况</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#5-%E8%AE%BF%E9%97%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">5. 访问静态资源文件</span></a></li><li class="toc-item toc-level-2"><a href="#6-%E5%A4%84%E7%90%86cookie" class="toc-link"><span class="toc-text">6. 处理cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#61-%E8%AE%BE%E7%BD%AEcookie" class="toc-link"><span class="toc-text">6.1 设置cookie</span></a></li><li class="toc-item toc-level-3"><a href="#62-%E8%AF%BB%E5%8F%96cookie" class="toc-link"><span class="toc-text">6.2 读取cookie</span></a></li><li class="toc-item toc-level-3"><a href="#63-%E5%88%A0%E9%99%A4cookie" class="toc-link"><span class="toc-text">6.3 删除cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#7-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" class="toc-link"><span class="toc-text">7. 文件上传</span></a></li><li class="toc-item toc-level-2"><a href="#8-%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8. 中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#81-%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.1 使用中间件</span></a></li><li class="toc-item toc-level-3"><a href="#82-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.2 自定义中间件</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#9-%E5%A4%84%E7%90%86session" class="toc-link"><span class="toc-text">9. 处理session</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#91-%E5%AE%89%E8%A3%85session%E5%8C%85" class="toc-link"><span class="toc-text">9.1 安装session包</span></a></li><li class="toc-item toc-level-3"><a href="#92-%E5%9F%BA%E6%9C%AC%E7%9A%84session%E7%94%A8%E6%B3%95" class="toc-link"><span class="toc-text">9.2 基本的session用法</span></a></li><li class="toc-item toc-level-3"><a href="#93-%E5%9F%BA%E4%BA%8Eredis%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84session" class="toc-link"><span class="toc-text">9.3 基于redis存储引擎的session</span></a></li></ol></li></ol></li></ol></div></main><aside class="right-column"><div class="sticky-widescreen"><article class="card card-content toc-card"><div class="toc-header"><i class="iconfont icon-menu" style="padding-right:2px"></i>目录</div><ol class="toc"><li class="toc-item toc-level-1"><a href="#gin-overall" class="toc-link"><span class="toc-text">Gin-overall</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a href="#1router" class="toc-link"><span class="toc-text">1.router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#11-%E8%B7%AF%E7%94%B1%E5%AE%9A%E4%B9%89%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">1.1 路由定义例子</span></a></li><li class="toc-item toc-level-3"><a href="#12-%E5%88%86%E7%BB%84%E8%B7%AF%E7%94%B1" class="toc-link"><span class="toc-text">1.2 分组路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#2%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.处理请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#21-%E8%8E%B7%E5%8F%96get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.1 获取Get请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#22-%E8%8E%B7%E5%8F%96post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.2 获取Post请求参数</span></a></li><li class="toc-item toc-level-3"><a href="#23-%E8%8E%B7%E5%8F%96url%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0" class="toc-link"><span class="toc-text">2.3 获取URL路径参数</span></a></li><li class="toc-item toc-level-3"><a href="#24-%E5%B0%86%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9Astruct%E5%AF%B9%E8%B1%A1" class="toc-link"><span class="toc-text">2.4 将请求参数绑定struct对象</span></a></li><li class="toc-item toc-level-3"><a href="#25-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7ip" class="toc-link"><span class="toc-text">2.5 获取客户ip</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#3-%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C" class="toc-link"><span class="toc-text">3. 返回响应结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#31-%E4%BB%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.1 以字符串方式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#32-%E4%BB%A5json-xml%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.2 以json、xml格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#33-%E4%BB%A5%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%93%8D%E5%BA%94%E8%AF%B7%E6%B1%82" class="toc-link"><span class="toc-text">3.3 以文件格式响应请求</span></a></li><li class="toc-item toc-level-3"><a href="#34-%E8%AE%BE%E7%BD%AEhttp%E5%93%8D%E5%BA%94%E5%A4%B4" class="toc-link"><span class="toc-text">3.4 设置http响应头</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#4-html%E6%A8%A1%E6%9D%BF%E5%A4%84%E7%90%86" class="toc-link"><span class="toc-text">4. html模板处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#41-%E8%BF%94%E5%9B%9Ehtml%E7%BB%93%E6%9E%9C%E7%9A%84%E4%BE%8B%E5%AD%90" class="toc-link"><span class="toc-text">4.1 返回html结果的例子</span></a></li><li class="toc-item toc-level-3"><a href="#42-%E5%A4%84%E7%90%86%E6%A8%A1%E7%89%88%E5%AD%90%E7%9B%AE%E5%BD%95%E7%9A%84%E6%83%85%E5%86%B5" class="toc-link"><span class="toc-text">4.2 处理模版子目录的情况</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#5-%E8%AE%BF%E9%97%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" class="toc-link"><span class="toc-text">5. 访问静态资源文件</span></a></li><li class="toc-item toc-level-2"><a href="#6-%E5%A4%84%E7%90%86cookie" class="toc-link"><span class="toc-text">6. 处理cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#61-%E8%AE%BE%E7%BD%AEcookie" class="toc-link"><span class="toc-text">6.1 设置cookie</span></a></li><li class="toc-item toc-level-3"><a href="#62-%E8%AF%BB%E5%8F%96cookie" class="toc-link"><span class="toc-text">6.2 读取cookie</span></a></li><li class="toc-item toc-level-3"><a href="#63-%E5%88%A0%E9%99%A4cookie" class="toc-link"><span class="toc-text">6.3 删除cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#7-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" class="toc-link"><span class="toc-text">7. 文件上传</span></a></li><li class="toc-item toc-level-2"><a href="#8-%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8. 中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#81-%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.1 使用中间件</span></a></li><li class="toc-item toc-level-3"><a href="#82-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6" class="toc-link"><span class="toc-text">8.2 自定义中间件</span></a></li></ol></li><li class="toc-item toc-level-2"><a href="#9-%E5%A4%84%E7%90%86session" class="toc-link"><span class="toc-text">9. 处理session</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a href="#91-%E5%AE%89%E8%A3%85session%E5%8C%85" class="toc-link"><span class="toc-text">9.1 安装session包</span></a></li><li class="toc-item toc-level-3"><a href="#92-%E5%9F%BA%E6%9C%AC%E7%9A%84session%E7%94%A8%E6%B3%95" class="toc-link"><span class="toc-text">9.2 基本的session用法</span></a></li><li class="toc-item toc-level-3"><a href="#93-%E5%9F%BA%E4%BA%8Eredis%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84session" class="toc-link"><span class="toc-text">9.3 基于redis存储引擎的session</span></a></li></ol></li></ol></li></ol></article><article class="card card-content"><div class="recent-posts-card"><div class="recent-posts-header"><i class="iconfont icon-wenzhang_huaban" style="padding-right:2px"></i>最近文章</div><div class="recent-posts-list"><div class="recent-posts-item"><div class="recent-posts-item-title">2022-09-17</div><a href="/mysql/"><div class="recent-posts-item-content">go-mysql</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-09-15</div><a href="/net-tcp/"><div class="recent-posts-item-content">net-tcp</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-09-12</div><a href="/go-reflect/"><div class="recent-posts-item-content">go-reflect</div></a></div><div class="recent-posts-item"><div class="recent-posts-item-title">2022-09-11</div><a href="/go-module/"><div class="recent-posts-item-content">go module</div></a></div></div></div></article></div></aside></div></div></div></div><!-- <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2020
          
          
                - 
                2022
          
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          xiaomao blog
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
</footer>
  --> <a class="basebutton" aria-label="回到顶部" id="scrollbutton" role="button"><i class="iconfont button-icon icon-arrowleft"></i> </a><a class="basebutton" aria-label="menu button" id="menubutton" role="button"><i class="iconfont button-icon icon-menu"></i> </a><a class="basebutton" aria-label="控制中心" id="popbutton" role="button"><i class="iconfont button-icon icon-expand"></i> </a><a class="basebutton darkwidget" aria-label="夜色模式" id="darkbutton" role="button"><i class="iconfont button-icon icon-weather"></i> </a><a class="basebutton searchwidget" aria-label="搜索" id="searchbutton" role="button"><i class="iconfont button-icon icon-search"></i></a><link href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" rel="stylesheet"><script>var addImgLayout=function(){for(var t=document.querySelectorAll(".post-content img"),e=0;e<t.length;e++){var a=document.createElement("a");a.setAttribute("href",t[e].getAttribute("data-src")),a.setAttribute("aria-label","illustration"),a.style.cssText="width: 100%; display: flex; justify-content: center;",t[e].alt&&(a.dataset.caption=t[e].alt),a.dataset.nolink=!0,t[e].before(a),a.append(t[e]);var r=document.createElement("div");r.classList.add("gallery"),a.before(r),r.append(a)}baguetteBox.run(".gallery")}</script><script>loadScript("/js/lib/lightbox/baguetteBox.min.js",addImgLayout)</script><script src="/js/main.js"></script><script>var addLazyload=function(){lozad(".lozad",{load:function(a){a.srcset=a.getAttribute("data-src")},loaded:function(a){a.classList.add("loaded")}}).observe()}</script><script>loadScript("/js/lib/lozad.min.js",addLazyload)</script><script src="//instant.page/5.1.0" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw" type="module"></script><script>setTimeout(() => {localSearch("search.json")}, 0)</script></body></html>